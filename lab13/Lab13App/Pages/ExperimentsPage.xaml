<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Lab13App.Pages.ExperimentsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:Lab13App.Models"
    Title="Эксперименты">

    <Grid RowDefinitions="Auto,Auto,*,Auto" Padding="16" RowSpacing="16">
        <VerticalStackLayout Spacing="8">
            <Entry x:Name="TitleEntry" Placeholder="Название *" />
            <Editor x:Name="DescriptionEditor" Placeholder="Описание" AutoSize="TextChanges" />
            <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                <DatePicker x:Name="StartDatePicker" Grid.Column="0" />
                <DatePicker x:Name="EndDatePicker" Grid.Column="1" />
            </Grid>
            <Picker
                x:Name="ResearcherPicker"
                Title="Руководитель *"
                ItemsSource="{Binding ResearcherOptions}"
                ItemDisplayBinding="{Binding FullName}" />
        </VerticalStackLayout>

        <HorizontalStackLayout Grid.Row="1" Spacing="8">
            <Button Text="Сохранить" Clicked="OnSaveClicked" />
            <Button Text="Удалить" Clicked="OnDeleteClicked" />
            <Button Text="Очистить" Clicked="OnClearClicked" />
        </HorizontalStackLayout>

        <CollectionView
            x:Name="ExperimentsCollection"
            Grid.Row="2"
            ItemsSource="{Binding Experiments}"
            SelectionMode="Single"
            SelectionChanged="OnSelectionChanged">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:Experiment">
                    <Border
                        Margin="0,4"
                        Padding="8"
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 8"
                        BackgroundColor="{AppThemeBinding Light='#F3F4F6', Dark='#111827'}">
                        <VerticalStackLayout Spacing="2">
                            <Label Text="{Binding Title}" FontAttributes="Bold" />
                            <Label
                                FontSize="12"
                                Text="{Binding PrincipalInvestigator.FullName, StringFormat='Руководитель: {0}'}"
                                TextColor="Gray" />
                            <Label
                                FontSize="12"
                                Text="{Binding StartDate, StringFormat='Начало: {0:dd.MM.yyyy}'}"
                                TextColor="Gray" />
                            <Label
                                FontSize="12"
                                Text="{Binding EndDate, StringFormat='Завершение: {0:dd.MM.yyyy}'}"
                                TextColor="Gray" />
                            <Label FontSize="12" Text="{Binding Description}" LineBreakMode="TailTruncation" />
                        </VerticalStackLayout>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Label
            Grid.Row="3"
            x:Name="StatusLabel"
            TextColor="Gray"
            FontSize="12" />
    </Grid>
</ContentPage>

